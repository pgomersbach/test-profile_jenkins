- job:
    name: <%= @name %>-doc
    description: 'Auto generated job, do not edit this job through the web!'
    project-type: freestyle
    block-downstream: false
    scm:
    - git:
        skip-tag: true
        url: <%= @jobgiturl %>
    triggers:
      - reverse:
            jobs: <%= @name %>-start
            result: 'success'
    builders:
      - shell: |
           rm -rf doc/;
           cd $WORKSPACE;
           BUNDLE_PATH="$JENKINS_HOME/shared/bundle";
           bundle install --path $BUNDLE_PATH;
           /opt/puppetlabs/bin/puppet strings;
           /opt/puppetlabs/bin/puppet help;
#           if [ -d ${WORKSPACE}/doc/files/${WORKSPACE}/modules ]; 
#             then mv -v "${WORKSPACE}/doc/files/${WORKSPACE}/modules" "${WORKSPACE}/doc/files/modules"
#           fi
#           grep -l -R ${WORKSPACE} * | while read fname; do perl -pi -e "s@${WORKSPACE}/@/@g" $fname; done
    publishers:
      - html-publisher:
          name: "HTML Report"
          dir: "doc"
          files: "index.html"
          keep-all: false
          allow-missing: false
    logrotate:
      daysToKeep: 3
      numToKeep: 2
